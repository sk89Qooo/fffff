<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SA-MP HUD</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
            color: white;
            user-select: none;
        }
        
        body {
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }
        
        .hud-container {
            position: absolute;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }
        
        /* Health and Armor */
        .status-bars {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 200px;
        }
        
        .status-bar {
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            background-color: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .status-fill {
            height: 100%;
            transition: width 0.3s ease;
        }
        
        #health .status-fill {
            background-color: #e74c3c;
        }
        
        #armour .status-fill {
            background-color: #3498db;
        }
        
        /* Money */
        .money-container {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
        }
        
        /* Wanted */
        .wanted-container {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        
        .wanted-star {
            width: 30px;
            height: 30px;
            margin: 2px;
            background-color: yellow;
            clip-path: polygon(
                50% 0%, 61% 35%, 98% 35%, 68% 57%, 
                79% 91%, 50% 70%, 21% 91%, 32% 57%, 
                2% 35%, 39% 35%
            );
        }
        
        /* Weapon */
        .weapon-container {
            position: absolute;
            bottom: 80px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
        }
        
        .weapon-icon {
            width: 40px;
            height: 40px;
            background-color: rgba(255, 255, 255, 0.2);
            margin-bottom: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
        }
        
        .ammo-count {
            font-size: 16px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="hud-container">
        <!-- Health and Armor -->
        <div class="status-bars">
            <div class="status-bar" id="health">
                <div class="status-fill" style="width: 100%"></div>
            </div>
            <div class="status-bar" id="armour">
                <div class="status-fill" style="width: 100%"></div>
            </div>
        </div>
        
        <!-- Money -->
        <div class="money-container" id="money">
            $0
        </div>
        
        <!-- Wanted Level -->
        <div class="wanted-container" id="wanted">
            <!-- Stars will be added dynamically -->
        </div>
        
        <!-- Weapon -->
        <div class="weapon-container" id="weapon-info" style="display: none;">
            <div class="weapon-icon" id="gunid">🔫</div>
            <div class="ammo-count" id="ammo"></div>
        </div>
    </div>

    <script>
        let health = document.getElementById('health').querySelector('.status-fill');
        let armour = document.getElementById('armour').querySelector('.status-fill');
        let moneys = document.getElementById('money');
        let wanteds = document.getElementById('wanted');
        let gunIcon = document.getElementById('gunid');
        let ammos = document.getElementById('ammo');
        let weaponContainer = document.getElementById('weapon-info');

        // Initialize CEF communication
        if (typeof cef !== 'undefined') {
            cef.emit("game:hud:setComponentVisible", "interface", false);
            
            cef.on("game:hud:newVisibleState", (success) => {
                if (typeof cef.hide === 'function') {
                    cef.hide(!success);
                }
            });

            cef.emit("game:data:pollPlayerStats", true, 50);
            
            cef.on("game:data:playerStats", (hp, max_hp, arm, breath, wanted, weapon, ammo, max_ammo, money, speed) => {
                // Update health
                const healthPercent = (hp / max_hp) * 100;
                health.style.width = `${healthPercent}%`;
                
                // Update armor
                const armorPercent = arm;
                armour.style.width = `${armorPercent}%`;
                
                // Update money
                moneys.textContent = `$${money.toLocaleString()}`;
                
                // Update wanted level
                updateWantedLevel(wanted);
                
                // Update weapon info
                updateWeaponInfo(weapon, ammo, max_ammo);
            });
        } else {
            // For testing without CEF
            console.log("CEF not detected - running in test mode");
            
            // Test data
            setInterval(() => {
                const testHP = Math.random() * 100;
                const testArmor = Math.random() * 100;
                const testMoney = Math.floor(Math.random() * 1000000);
                const testWanted = Math.floor(Math.random() * 6);
                const testWeapon = Math.floor(Math.random() * 10);
                const testAmmo = Math.floor(Math.random() * 30);
                const testMaxAmmo = 30;
                
                health.style.width = `${testHP}%`;
                armour.style.width = `${testArmor}%`;
                moneys.textContent = `$${testMoney.toLocaleString()}`;
                updateWantedLevel(testWanted);
                updateWeaponInfo(testWeapon, testAmmo, testMaxAmmo);
            }, 1000);
        }
        
        function updateWantedLevel(level) {
            // Clear existing stars
            wanteds.innerHTML = '';
            
            // Add new stars (max 6 as in GTA)
            level = Math.min(6, level);
            for (let i = 0; i < level; i++) {
                const star = document.createElement('div');
                star.className = 'wanted-star';
                wanteds.appendChild(star);
            }
        }
        
        function updateWeaponInfo(weapon, ammo, max_ammo) {
            if (weapon === 0) {
                // No weapon
                weaponContainer.style.display = 'none';
                return;
            }
            
            weaponContainer.style.display = 'flex';
            
            // Simple weapon icons based on common types
            let weaponSymbol = '🔫';
            if (weapon >= 22 && weapon <= 24) weaponSymbol = '🔪'; // Knife
            else if (weapon >= 25 && weapon <= 27) weaponSymbol = '💣'; // Grenades
            else if (weapon >= 28 && weapon <= 32) weaponSymbol = '🔫'; // Pistols
            else if (weapon >= 33 && weapon <= 34) weaponSymbol = '🔫'; // Deagle, shotgun
            else if (weapon >= 35 && weapon <= 38) weaponSymbol = '🏹'; // Rifles
            else if (weapon >= 41 && weapon <= 43) weaponSymbol = '🔥'; // Flamethrower, minigun
            
            gunIcon.textContent = weaponSymbol;
            ammos.textContent = `${ammo}/${max_ammo}`;
        }
    </script>
</body>
</html>
